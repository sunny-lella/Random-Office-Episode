
const episode_list = ["70105212","70069628","70069629","70069630","70069631","70069632", //season 1
                      "70069633","70069634","70069635","70069636","70069637","70069638","70069639","70069640","70069641","70069642","70069643","70069644","70069645","70069646","70069647","70069648","70069649","70069650","70069651","70069652","70069653","70069654", //season 2
                      "70080635","70080631","70080633","70080636","70080637","70080634","70080628","70080639","70080632","70080627","70080624","70080645","70080643","70080626","70080641","70080629","70080630","70080640","70080644","70080642","70080646","70080625","70080638", //season 3
                      "70108687","70108688","70108689","70108690","70108691","70108692","70108693","70108694","70108695","70108696","70108697","70108698","70108699","70108700", //season 4
                      "70126223","70126250","70126224","70126225","70126226","70126227","70126228","70126229","70126230","70126231","70126232","70126233","70126234","70126235","70126249","70126236","70126237","70126238","70126239","70126240","70126241","70126242","70126243","70126244","70126245"
                        ,"70126246","70126247","70126248", //season 5
                      "70151933","70151934","70151935","70151936","70151937","70151938","70151939","70151940","70151941","70151942","70151943","70151944","70151945","70151946","70151947","70151948","70151949","70151950","70151951","70151952","70151953","70151954","70151955","70151956","70151957"
                        ,"70151958", // season 6
                      "70189006","70189007","70189008","70189009","70189010","70189011","70189012","70189013","70189014","70189015","70189016","70189017","70189018","70189019","70189020","70189021","70189022","70189023","70189024","70189025","70189026","70189027","70189028","70189029","70189030"
                        ,"70189031", //season 7
                      "70210965","70210966","70210967","70210968","70210969","70210970","70210971","70210972","70210973","70210974","70210975","70210976","70210977","70210978","70210979","70210980","70210981","70210982","70210983","70210984","70210985","70210986","70210987","70210988", //season 8
                      "70286845","70286846","70286847","70286848","70286849","70286850","70286851","70286852","70286853","70286854","70286855","70286856","70286857","70286858","70286859","70286860","70286861","70286862","70286863","70286864","70286865","70286866","70286867" //season 9
                     ];

var id = null;

function randEpisode() {
  var random_episode = Math.floor(Math.random() * 192) + 1;
  var url = "https://www.netflix.com/watch/" + episode_list[random_episode-1];
  return url;
}

function openNewTab(url) {
  chrome.tabs.create({"url": url}, function(tab) {
    id = tab.id;
  });
}

function updateCurrentTab(url) {
  chrome.tabs.update(id,{"url": url});
}


chrome.browserAction.onClicked.addListener(function (tab) {
  randUrl = randEpisode();
  if(id==null) {
    openNewTab(randUrl);
  }
  else {
    updateCurrentTab(randUrl);
  }
});


chrome.tabs.onRemoved.addListener(function(closed_tab) {
  if(closed_tab == id) {
    id = null;
  }
});
